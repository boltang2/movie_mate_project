<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mmcomment">
	<select id="selectList" resultType="vo.CommentList_ViewVO"
		parameterType="vo.MovieMate_MovieVO">
		select mmu.user_idx, mmu.username, mmu.profile_img,
		mc.com_content content, mc.comment_idx, mc.up, mc.m_ref, mc.regdate,
		mu.star_score, mu.want_view from moviemate_user mmu, moviemate_comment
		mc, movie_user mu where mmu.username = mc.com_username AND mc.m_ref =
		mu.movie_idx AND
		mmu.user_idx = mu.user_idx AND m_ref = #{movie_idx}
		AND comment_idx =
		c_ref
		AND(1=2 OR star_score > 0 Or want_view =
		'yes')
	</select>

	<select id="myComment" resultType="vo.MovieMate_CommentVO"
		parameterType="vo.MovieMate_CommentVO">
		SELECT * FROM moviemate_comment WHERE com_username =
		#{com_username} AND m_ref = #{m_ref} AND comment_idx = c_ref
	</select>

	<insert id="insert" parameterType="vo.MovieMate_CommentVO">
		INSERT INTO moviemate_comment
		VALUES(seq_comment_idx.nextVal,#{com_username},#{com_content},
		0,
		#{m_ref}, 0, 0, 0, seq_comment_idx.currVal, sysdate)
	</insert>

	<update id="update" parameterType="vo.MovieMate_CommentVO">
		UPDATE moviemate_comment SET
		com_content = #{com_content}
		WHERE comment_idx = #{comment_idx}
	</update>
</mapper>








