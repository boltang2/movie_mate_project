<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mmmovie">
	<select id="openApi_count" resultType="int"
		parameterType="vo.MovieMate_MovieVO">
		SELECT COUNT(*) FROM moviemate_movie WHERE title =
		#{title} AND release_date = TO_DATE(#{release_date},'YYYY/MM/DD')
	</select>

	<insert id="openApi_insert" parameterType="vo.MovieMate_MovieVO">
		INSERT INTO
		moviemate_movie values(seq_movie_idx.nextVal, #{profile_img},
		#{background_img},
		#{title},
		TO_CHAR(TO_DATE(#{release_date},'YYYY/MM/DD'),'YYYY/MM/DD'),
		#{nation}, #{genre}, #{running_time}, #{company},
		#{movie_info},
		#{film_rating}, #{star_score}, #{attandance})
	</insert>


	<select id="boxoffice_list" resultType="vo.MovieMate_MovieVO"
		parameterType="vo.MovieMate_MovieVO">
		SELECT * FROM (SELECT RANK() OVER(ORDER BY release_date DESC) no, m.*
		FROM moviemate_movie m)sub WHERE no BETWEEN 1 AND 15
	</select>


<!-- 	<select id="boxoffice_list" resultType="vo.MovieMate_MovieVO"
		parameterType="vo.MovieMate_MovieVO">
		SELECT * FROM (SELECT RANK() OVER(ORDER BY release_date
		DESC) no, m.*
		FROM moviemate_movie m)sub WHERE no BETWEEN 1 AND 15
	</select>
 -->


	<select id="top10_list" resultType="vo.MovieMate_MovieVO"
		parameterType="vo.MovieMate_MovieVO">
		SELECT *
		FROM (
		SELECT RANK() OVER(ORDER BY movie_idx
		DESC) no, m.*
		FROM moviemate_movie m
		) sub
		WHERE no BETWEEN 1 AND 15
	</select>
 
	<!-- <select id="selectMovieIdx" resultType="vo.MovieMate_MovieVO"
      parameterType="vo.Movie_CastVO">
        SELECT * FROM moviemate_movie WHERE movie_idx = #{movie_idx}
    </select>  -->
	

	<select id="masterpiece_list" resultType="vo.MovieMate_MovieVO"
		parameterType="vo.MovieMate_MovieVO">
		select * from moviemate_movie
		where release_date
		between'19900101'and '20100101'and star_score > 4
	</select>

	<select id="selectMovieIdx" resultType="vo.MovieMate_MovieVO"
		parameterType="vo.Movie_CastVO">
	  	SELECT * FROM moviemate_movie WHERE movie_idx = #{movie_idx}
    </select>
		




      
		

	
	
	
	


</mapper>











